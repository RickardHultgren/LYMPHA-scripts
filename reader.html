<html>
    <head>
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    </head>
<body style="margin:3em;">
    Select ICD:
    <select id="ICD" name="ICD">
        <option value="NFB29">NFB29 Primär total höftledsplastik utan cement</option>
        <option value="NGB49">NGB49 Primär totalprotes i knäled med cement</option>
    </select>
    <button id="select-button" type="submit" pys-onClick="select_function" style="border-color:#000;border-width:1px;"/>>OK</button>

<hr style="margin:0em 0em 1.5em 0em;" >
<hr style="margin:0em 0em 1.5em 0em;" >
<hr style="margin:0em 0em 1.5em 0em;" >
    <div>Type in date input here</div>
    <input style="margin:0em 0em 1.5em 0em;" type="text" id="indate-input" style="border-color:#000;border-width:1px;"/>

    <div>Type out dateinput here</div>
    <input style="margin:0em 0em 1.5em 0em;" type="text" id="outdate-input" style="border-color:#000;border-width:1px;"/>

    <div>Type op date input here</div>
    <input style="margin:0em 0em 1.5em 0em;" type="text" id="opdate-input" style="border-color:#000;border-width:1px;"/>

    <div>Type type input here</div>
    <input style="margin:0em 0em 1.5em 0em;" type="text" id="type-input" style="border-color:#000;border-width:1px;"/>

    <div>Type side input here</div>
    <select style="margin:0em 0em 1.5em 0em;" id="side-input">
        <option value="höger sida">höger sida</option>
        <option value="vänster sida">vänster sida</option>
        <option value="båda sidor">båda sidor</option>
    </select>

    <div>Type ward input here</div>
    <input style="margin:0em 0em 1.5em 0em;" type="text" id="ward-input" style="border-color:#000;border-width:1px;"/>

    <button id="submit-button" type="submit" pys-onClick="submit_function" style="border-color:#000;border-width:1px;">OK</button>
    <hr style="border:1em;">
    <div id="output"></div>
<hr style="margin:0em 0em 1.5em 0em;" >
<hr style="margin:0em 0em 1.5em 0em;" >
<hr style="margin:0em 0em 1.5em 0em;" >
<div id="pharma-list">
</div>
<hr style="margin:0em 0em 1.5em 0em;" >
<hr style="margin:0em 0em 1.5em 0em;" >
<hr style="margin:0em 0em 1.5em 0em;" >
<div id="plan"></div>
    <py-env>
    </py-env>
    <py-script>
    from js import console
    from datetime import date
    from datetime import timedelta


    indate = str("")
    outdate = str("")
    opdate = str("")
    type = str("")
    side = str("")
    ward = str("")
    pharma = str("")

    today = date.today()
    yesterday = today - timedelta(days = 1)

    def select_function(*args, **kwargs):

        console.log(f'args: {args}')
        console.log(f'kwargs: {kwargs}')
    
        ICD = Element('ICD').element.value        
        if ICD == "NFB29" :
            Element('type-input').element.value = "primär total höftledsplastik utan cement"
            Element('ward-input').element.value = "78"
            Element('pharma-list').element.innerText = ("Cilaxoral 7,5mg/ml 10droppar i 1en vecka mot förstoppning.\nEliquis 2,5mg 1 tablett 2 gånger dagligen i 30 dagar mot blodproppar\nOmeprazol 20mg 1 tablett 1gång dagligen i 1 vecka, magskyddande.\nOxynorm 5mg 2vb, max 4 per dag. Smärtstillande\nParacetamol 500mg 2 tabletter 3 gånger dagligen i 4 veckor. Smärtstillande.\n")
            Element('plan').element.innerText = ("")
        if ICD == "NGB49" :
            Element('type-input').element.value = "primär totalprotes i knäled med cement"
            Element('ward-input').element.value = "78"
            Element('pharma-list').element.innerText = ("Etoricoxib 120mg 1 tablett 1 gånger dagligen i 5 dagar. Mot smärta.\nCilaxoral 7,5mg/ml 10 droppar i 1 vecka. Mot förstoppning.\nEliquis 2,5mg 1 tablett 2 gånger dagligen i 20 dagar. Förebygger blodpropp.\nOmeprazol 20mg 1 tablett 1 gång dagligen i 1 vecka. Magskyddande.\nOxynorm 5mg 1 vid behov, max 4 dagligen, i 2 veckor. Smärtstillande.\nParacetamol 500mg 2 tabletter 3 gånger dagligen i 4 veckor. Smärtstillande. ")
            Element('plan').element.innerText = ("")
        Element('indate-input').element.value = (str(yesterday))

    def submit_function(*args, **kwargs):

        global indate 
        global outdate 
        global opdate 
        global type 
        global side 
        global ward 

        #print('args:', args)
        #print('kwargs:', kwargs)

        console.log(f'args: {args}')
        console.log(f'kwargs: {kwargs}')
    
        indate = Element('indate-input').element.value
        outdate = Element('outdate-input').element.value
        opdate = Element('opdate-input').element.value
        type = Element('type-input').element.value
        side = Element('side-input').element.value
        ward = Element('ward-input').element.value

        #print('indate:', indate)
        console.log(f'indate: {indate}')
        console.log(f'outdate: {outdate}')
        console.log(f'opdate: {opdate}')
        console.log(f'type: {type}')
        console.log(f'side: {side}')
        console.log(f'ward: {ward}')
        Element('output').element.innerText = ("Du inkom %s till ortopeden Arvika sjukhus för %s %s som opererades in den %s. Operationen var komplikationsfri och efter operationen har du mått väsentligen bra. Du är adekvat smärtlindrad och har kunnat mobiliseras bra med sjukgymnast på avdelningen. Du anses tillsammans med oss vara utskrivningsklar från avdelning %s." % (indate, type, side, opdate, ward))

    #print("Du inkom %s till ortopeden Arvika sjukhus för %s %s sida som opererades in den %s. Operationen var komplikationsfri och efter operationen har du mått väsentligen bra. Du är adekvat smärtlindrad och har kunnat mobiliseras bra med sjukgymnast på avdelningen. Du anses tillsammans med oss vara utskrivningsklar från avdelning %s." % (indate, type, side, opdate, ward))

    </py-script>
</body>
</html>
